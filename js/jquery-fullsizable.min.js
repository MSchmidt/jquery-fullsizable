/*
jQuery fullsizable plugin v2.2.0 <https://github.com/MSchmidt/jquery-fullsizable>
(c) 2011-2015 Matthias Schmidt <http://m-schmidt.eu/>
*/
(function(){var c;var b=jQuery;var d=b('<div id="jquery-fullsizable"><div id="fullsized_wrapper"><div id="fullsized_holder"><div id="fullsized_image_holder"></div></div></div></div>');var g=b('<div id="fullsized_caption_holder"></div>');var e=[];var f=0;var t=c=null;var h=function(){var a=e[f];null==a.ratio&&(a.ratio=(a.naturalHeight/a.naturalWidth).toFixed(2));if(b(window).height()/a.ratio>b(window).width())return b(a).width(b(window).width()),b(a).height(b(window).width()*a.ratio),b(a).css("margin-top",(b(window).height()-b(a).height())/2);b(a).height(b(window).height());b(a).width(b(window).height()/a.ratio);return b(a).css("margin-top",0)};var u=function(a){27===a.keyCode&&n();if(c.navigation&&(37===a.keyCode&&r(!0),39===a.keyCode))return p(!0)};var r=function(a){null==a&&(a=!1);if(0<f)return l(e[f-1],-1,a);if(c.loop)return l(e[e.length-1],-1,a)};var p=function(a){null==a&&(a=!1);if(f<e.length-1)return l(e[f+1],1,a);if(c.loop)return l(e[0],1,a)};var l=function(a,k,e){null==k&&(k=1);null==e&&(e=!1);f=a.index;b("#fullsized_image_holder").hide();b("#fullsized_image_holder").html(a);c.caption&&(a.caption?(g.html(a.caption),g.css({visibility:"visible"})):g.css({visibility:"hidden"}));c.navigation&&(!0===e?A():v());if(null!=a.loaded)return b("#jquery-fullsizable").removeClass("fullsized_spinner"),h(),b("#fullsized_image_holder").fadeIn("fast"),w(k);b("#jquery-fullsizable").addClass("fullsized_spinner");a.onload=function(){h();b("#fullsized_image_holder").fadeIn("slow",function(){return b("#jquery-fullsizable").removeClass("fullsized_spinner")});this.loaded=!0;return w(k)};return a.src=a.buffer_src};var w=function(a){if(1===a&&f<e.length-1)a=e[f+1];else if((-1===a||f===e.length-1)&&0<f)a=e[f-1];else return;a.onload=function(){return this.loaded=!0};if(""===a.src)return a.src=a.buffer_src};var x=function(a,e){b("body").append(d);b(window).bind("resize",h);l(a);return b("#jquery-fullsizable").hide().fadeIn(function(){null!=c.detach_id&&(t=b(window).scrollTop(),b("#"+c.detach_id).css("display","none"),h());B();return b(document).trigger("fullsizable:opened",e)})};var n=function(){null!=c.detach_id&&(b("#"+c.detach_id).css("display","block"),b(window).scrollTop(t));b("#jquery-fullsizable").fadeOut(function(){return d.remove()});C();b("#jquery-fullsizable").removeClass("fullsized_spinner");D();return b(window).unbind("resize",h)};var q=function(){e.length=0;return c.fullsizableElements.each(function(){var a=new Image;var d=b(this);var f=d.children("img:first");a.buffer_src=d.attr("href");a.index=e.length;c.caption&&(a.caption="",f.attr("title")&&(a.caption+="<b>"+f.attr("title")+"</b><br>"),f.attr("alt")&&(a.caption+=f.attr("alt")));e.push(a);if(c.openOnClick)return d.unbind("click").click(function(b){b.preventDefault();c.reloadOnOpen&&q();return x(a,this)})})};var F=function(){c.navigation&&0===d.find("#fullsized_go_prev").length&&(d.append('<button id="fullsized_go_prev" type="button" title="Previous"></button><button id="fullsized_go_next" type="button" title="Next"></button>'),b(document).on("click","#fullsized_go_prev",function(a){a.preventDefault();a.stopPropagation();return r()}),b(document).on("click","#fullsized_go_next",function(a){a.preventDefault();a.stopPropagation();return p()}));c.closeButton&&0===d.find("#fullsized_close").length&&(d.append('<button id="fullsized_close" type="button" title="Close"></button>'),b(document).on("click","#fullsized_close",function(a){a.preventDefault();a.stopPropagation();return n()}));c.fullscreenButton&&E()&&0===d.find("#fullsized_fullscreen").length&&(d.append('<button id="fullsized_fullscreen" type="button" title="Toggle fullscreen"></button>'),b(document).on("click","#fullsized_fullscreen",function(a){a.preventDefault();a.stopPropagation();return y()}));c.caption&&d.find("#fullsized_holder").append(g);switch(c.clickBehaviour){case "close":return b(document).on("click","#jquery-fullsizable",n);case "next":return b(document).on("click","#jquery-fullsizable",function(){return p(!0)});default:return b(document).on("click","#jquery-fullsizable",c.clickBehaviour)}};var B=function(){b(document).bind("keydown",u);c.navigation&&(b(document).bind("fullsizable:next",function(){return p(!0)}),b(document).bind("fullsizable:prev",function(){return r(!0)}));return b(document).bind("fullsizable:close",n)};var D=function(){b(document).unbind("keydown",u);c.navigation&&(b(document).unbind("fullsizable:next"),b(document).unbind("fullsizable:prev"));return b(document).unbind("fullsizable:close")};var A=function(){g.toggle(!1);var a=d.find("button");if(!0===a.is(":visible"))return a.toggle(!1),d.css("cursor","none"),d.bind("mousemove",z)};var m=null;var z=function(a){null===m&&(m=[a.clientX,a.clientY]);if(10<=Math.round(Math.sqrt(Math.pow(m[1]-a.clientY,2)+Math.pow(m[0]-a.clientX,2))))return d.unbind("mousemove",z),m=null,v()};var v=function(){g.toggle(!0);b("#fullsized_close,#fullsized_fullscreen").toggle(!0);d.css("cursor","auto");if(c.loop)return b("#fullsized_go_prev").show(),b("#fullsized_go_next").show();b("#fullsized_go_prev").toggle(0!==f);return b("#fullsized_go_next").toggle(f!==e.length-1)};b.fn.fullsizable=function(a){c=b.extend({fullsizableElements:this,detach_id:null,navigation:!0,closeButton:!0,fullscreenButton:!0,openOnClick:!0,clickBehaviour:"close",preload:!0,reloadOnOpen:!1,loop:!1,caption:!1},a||{});F();c.preload&&q();b(document).bind("fullsizable:reload",q);b(document).bind("fullsizable:open",function(a,d){var f;c.reloadOnOpen&&q();var k=[];var g=0;for(f=e.length;g<f;g++){var h=e[g];h.buffer_src===b(d).attr("href")?k.push(x(h,d)):k.push(void 0)}return k});return this};var E=function(){var a=d.get(0);return a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen?!0:!1};var C=function(){return y(!0)};var y=function(a){var b=d.get(0);if(b.requestFullScreen)return document.fullScreen||a?document.exitFullScreen():b.requestFullScreen();if(b.webkitRequestFullScreen)return document.webkitIsFullScreen||a?document.webkitCancelFullScreen():b.webkitRequestFullScreen();if(b.mozRequestFullScreen)return document.mozFullScreen||a?document.mozCancelFullScreen():b.mozRequestFullScreen()}}).call(this);
